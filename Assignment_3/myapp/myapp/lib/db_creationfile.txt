CREATE TABLE IF NOT EXISTS QuizTopic (
	id INTEGER CONSTRAINT PK_QuizTopic PRIMARY KEY AUTOINCREMENT, 
	title VARCHAR(50) NOT NULL, 
	description_link VARCHAR(255) NOT NULL, 
	enabled BOOLEAN NOT NULL
);

CREATE TABLE IF NOT EXISTS Quiz (
	id INTEGER CONSTRAINT PK_QuizTopic PRIMARY KEY AUTOINCREMENT, 
	topic_id INT NOT NULL, 
	title VARCHAR(50) NOT NULL,
	enabled BOOLEAN NOT NULL,
	CONSTRAINT FK_QuizTopic FOREIGN KEY (topic_id) REFERENCES QuizTopic(id) ON DELETE NO ACTION ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS QuizQuestionType (
	id INTEGER CONSTRAINT PK_QuizQuestionType PRIMARY KEY AUTOINCREMENT, 
	type VARCHAR(50) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS QuizQuestionType (
	id INTEGER CONSTRAINT PK_QuizQuestion PRIMARY KEY AUTOINCREMENT, 
	quiz_id INT NOT NULL,
	quiz_question_type_id INT NOT NULL,
	title VARCHAR(50) NOT NULL,
	problem_statement VARCHAR(255) NOT NULL,
	enabled BOOLEAN NOT NULL,
	CONSTRAINT FK_Quiz FOREIGN KEY (quiz_id) REFERENCES Quiz(id) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT FK_QuizQuestionType FOREIGN KEY (quiz_question_type_id) REFERENCES QuizQuestionType(id) ON DELETE NO ACTION ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS QuizQuestionAnswer (
	id INTEGER CONSTRAINT PK_QuizQuestionAnswer PRIMARY KEY AUTOINCREMENT, 
	quiz_question_id INT NOT NULL,
	answer VARCHAR(255) NOT NULL,
	correct BOOLEAN NOT NULL,
	CONSTRAINT FK_QuizQuestion FOREIGN KEY (quiz_question_id) REFERENCES QuizQuestion(id) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS User (
	id INTEGER CONSTRAINT PK_User PRIMARY KEY AUTOINCREMENT,
	firstname VARCHAR(50) NOT NULL,
	middlename VARCHAR(50),
	lastname VARCHAR(50) NOT NULL,
	username VARCHAR(50) NOT NULL UNIQUE,
	password VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS UserAttemptStatus (
	id INTEGER CONSTRAINT PK_UserAttemptStatus PRIMARY KEY AUTOINCREMENT, 
	status VARCHAR(50) NOT NULL UNIQUE
);


CREATE TABLE IF NOT EXISTS UserAttempt (
	id INTEGER CONSTRAINT PK_UserAttempt PRIMARY KEY AUTOINCREMENT, 
	user_id INT NOT NULL,
	quiz_id INT NOT NULL,
	user_attempt_status_id INT ONT NULL,
	session_id VARCHAR(255) NOT NULL,
	CONSTRAINT FK_User FOREIGN KEY (user_id) REFERENCES User(id) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT FK_Quiz FOREIGN KEY (quiz_id) REFERENCES Quiz(id) ON DELETE SET NULL ON UPDATE CASCADE,
	CONSTRAINT FK_UserAttemptStatus FOREIGN KEY (user_attempt_status_id) REFERENCES UserAttemptStatus(id) ON DELETE NO ACTION ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS UserAttemptAnswer (
	id INTEGER CONSTRAINT PK_UserAttemptAnswer PRIMARY KEY AUTOINCREMENT, 
	quiz_question_id INT NOT NULL,
	user_attempt_id INT NOT NULL,
	user_question_answer VARCHAR(50) NOT NULL,
	correct BOOLEAN NOT NULL,
	CONSTRAINT FK_UserAttempt FOREIGN KEY (user_attempt_id) REFERENCES UserAttempt(id) ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT FK_QuizQuestion FOREIGN KEY (quiz_question_id) REFERENCES QuizQuestion(id) ON DELETE CASCADE ON UPDATE CASCADE
);




